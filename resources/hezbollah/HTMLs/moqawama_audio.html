<!DOCTYPE html>
    <html lang="ar">
    <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.ico">
    <title> :: الصفحة الرئيسية</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <link rel="canonical" href="https://audio.moqawama.org.lb/index.php" />


    <meta property="og:url"     content="https://audio.moqawama.org.lb/" />
    <meta property="og:type"    content="music.album" />
    <meta property="og:title"   content=" :: الصفحة الرئيسية" />
    <meta property="og:description"  content="" />
    <meta property="og:image"    content="https://audio.moqawama.org.lb/uploaded/default-moq.png" />
    
    
    <meta name="twitter:title" content="الصفحة الرئيسية" />
    <meta name="twitter:description" content="" />
    <meta name="twitter:image" content="https://audio.moqawama.org.lb/uploaded/default-moq.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:domain" content="https://audio.moqawama.org.lb" />
    <meta name="twitter:site" content="https://audio.moqawama.org.lb/" />
    <meta name="twitter:creator" content="moqawama.org.lb" />    

    <meta property="fb:app_id" content="112507282651474"/>

    <link href="assets/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="assets/bootstrap/css/bootstrap-responsive.css" type="text/css" rel="stylesheet"/>
    <link href="assets/bootstrap/css/bootstrap-slider.css" type="text/css" rel="stylesheet"/>
    <link href="assets/css/rtl.css" rel="stylesheet">
    <link href="assets/css/fonts.css" rel="stylesheet">
    <link href="assets/css/font-awesome.css" rel="stylesheet">
    <link href="assets/css/custom.css" rel="stylesheet">
    <link href="assets/css/ihover.css" rel="stylesheet">

    <!--[if lt IE 9]>
    <script src="assets/js/modernizr.js"></script>
    <![endif]-->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z8F3HPDSWG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z8F3HPDSWG');
</script>
</head>


<body class="greybg">

<!--header-->
<header>

    <div class="yellow-bg">

        <div class="clearfix">
            <div class="col-md-6 col-sm-6 col-xs-12">

                <div class="logo-header clearfix">
                    <a href="index.php" title="الصفحة الرئيسة">
                        <img src="assets/images/logo.png">
                        <div class="txt hidden-xs">
                            <h1> </h1>
                            <p> </p>
                        </div>
                    </a>
                </div>


            </div>
            <div class="col-md-6 col-sm-6 col-xs-12 text-left">
                <div class="icons">
                    <a href="index.php" title="الصفحة الرئيسة"><i class="fa fa-home"></i></a>
                    <a target="_blank" href="http://gallery.moqawama.org.lb" title="معرض الصور"><i class="fa fa-camera"></i></a>
                    <a target="_blank" href="http://video.moqawama.org.lb" title="معرض الفيديو"><i class="fa fa-video-camera"></i></a>
                    <a href="mailto:info@moqawama.org.lb?subject=موقع المقاومة-اوديو&amp;body=لتتواصل معنا, أرسل رسالة الكتروية" title="تواصل معنا">
                        <i class="fa fa-envelope-o" aria-hidden="true"></i></a>
                </div>
            </div>
        </div>


    </div>

    <div class="grey-bg">
        <div class="container">
            <div class="row">
                <div class="col-md-4 col-sm-6 ">
                    <div class="video-menu">


                        <h1>مكتبة الصوتيات</h1>
                    </div>
                </div>
                <div class="col-md-8  col-sm-6 text-left">

                    <div class="menu">

                        <nav class="navbar" role="navigation">
                            <div class="navbar-header  hidden-xs">
                                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                                        data-target="#bs-example-navbar-collapse-1">
                                    القائمة
                                </button>
                            </div>
                            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                                <ul class="nav navbar-nav">
                                                                                <li>
                                                <a href="albumdetails.php?albumid=57">
                                                    الشيخ نعيم قاسم                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=56">
                                                    وصايا الشهداء                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=1">
                                                    السيد حسن نصر الله                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=34">
                                                    فلاشات                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=13">
                                                    أناشيد                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=4">
                                                    الشيخ راغب حرب                                                </a>
                                            </li>
                                                                                <li style="display: none">
                                        <a href="" target="_blank">
                                            <img class="cloud" src="assets/images/pic2017/cloud.png"></a>

                                        </a>
                                    </li>

                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>

        </div>

    </div>

</header>

 <link rel="stylesheet" type="text/css" href="assets/plugin/bnews/css/breakingNews.css"/>
<!--end header-->
<style>
.breakingNews {
width: 100%;
    height: 40px;
    background: #e6e6e6;
    position: relative;
    border: solid 2px #d6d6d6;
    overflow: hidden;
}
</style>
<div class="container">
    <div class="row">
        <div class="col-md-12">
    <div class="newsbar"><div class="breakingNews" id="bn1">
                    <div class="bn-title"></div>
                    <ul>
                                            </ul>
                    <div class="bn-navi">
                        <span></span>
                        <span></span>
                    </div>
                </div>
                </div>
    </div>
        <div class="col-md-2">
            <div class="right-block">
                <h1>الرئيسية</h1>
            </div>
            <div id="sidenav1">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#sideNavbar"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
                </div>
                <div class="collapse navbar-collapse" id="sideNavbar">
                    <div class="panel-group" id="accordion">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title"><a href="index.php">
                                        <span class="glyphicon glyphicon-music"></span>آخر الإضافات </a></h4>
                            </div>
                        </div>



                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a data-toggle="collapse" data-parent="#accordion" href="#collapseFour">
                                        <span class="glyphicon glyphicon-picture"></span> ألالبومات</a></h4>
                            </div>
                            <div id="collapseFour" class="panel-collapse collapse in">
                                <ul class="list-group">

                                                                                <li>
                                                <a href="albumdetails.php?albumid=57" class="navlink">
                                                    الشيخ نعيم قاسم                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=56" class="navlink">
                                                    وصايا الشهداء                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=1" class="navlink">
                                                    السيد حسن نصر الله                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=55" class="navlink">
                                                    خطاب عاشوراء                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=24" class="navlink">
                                                    أدعية                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=34" class="navlink">
                                                    فلاشات                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=13" class="navlink">
                                                    أناشيد                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=54" class="navlink">
                                                    أناشيد رمضانية                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=44" class="navlink">
                                                    نغمات للهاتف                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=3" class="navlink">
                                                    السيد عباس الموسوي                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=5" class="navlink">
                                                    الإمام موسى الصدر                                                </a>
                                            </li>
                                                                                        <li>
                                                <a href="albumdetails.php?albumid=4" class="navlink">
                                                    الشيخ راغب حرب                                                </a>
                                            </li>
                                                                            </ul>
                            </div>
                        </div>

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a href="playlist.php"><span class="glyphicon glyphicon-play"></span>قائمة التشغيل </a> </h4>
                            </div>
                        </div>
                        <!-- end hidden Menu items -->
                    </div>
                </div>
            </div>

            <div class="right-block hidden-xs">
                <h1>إحصاءات</h1>
            </div>
            <div id="sidenav1">
                <div class="navbar-header hidden-xs">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#sideNavbar"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
                </div>
                <div class="collapse navbar-collapse" id="sideNavbar">
                    <div class="panel-group" id="accordion">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">عدد الألبومات : 12   </h4>
                            </div>
                        </div>

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">عدد الملفات : 2041  </h4>
                            </div>
                        </div>

                        <!--                        <div class="panel panel-default">-->
                        <!--                            <div class="panel-heading">-->
                        <!--                                <h4 class="panel-title"><a href="readstats.php">تفصيل الزيارات </a></h4>-->
                        <!--                            </div>-->
                        <!--                        </div>-->


                    </div>
                </div>
            </div>


        </div>

        <div class="col-md-10">
            <form role="form" action="search.php" method="get">
    <input type="text" name="search" placeholder="الرجاء إدخال كلمة البحث">
</form>

 <div id="results"></div>
<div class="loading-info text-center"><img src="assets/images/ajax-loader.gif" /></div>        </div>

    </div>


</div>



<div class="playlist" style="display:none;" >
    <div class="row">
        <div class="col-xs-12 col-md-5">
            <div class="word">
                <img class="linkimage_play" src="uploaded/default-moq.png">
                <h3 class="linkname_h3_play"></h3>
            </div>
        </div>
        <div class="col-xs-8 col-md-5">
            <div class="audioo">
                <div class="row">
                    
                 <div class="hidden-xs col-md-2">
                        <div class="wavesurfer-volume-block">
                      <input id="volume" type="range" min="0" max="1" value="1" step="0.1">
                        </div>
                    </div>
                    
                    <div class="hidden-xs col-md-2">
                        <div class="wavesurfer-time-duration-block  text-left">
                            <div class="wavesurfer-duration"></div>
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-6">

                        <div class="progress_container">
                            <div class="progress_bar tip" title="0"></div>
                        </div>

                    </div>
                    <div class="hidden-xs col-md-2">
                        <div class="wavesurfer-time-duration-block">
                            <div class="wavesurfer-time"></div>
                        </div>
                    </div>
                    

                    
                    
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-2">
            <div class="controls">
                            <div id="skip" style="margin-top: 5px;" class="">
            <img  src="assets/images/skip.png" class="linkname_icon_skip"  ></div>
                            <div id="play" style="margin-top: 5px;">
            <img  src="assets/images/play.png" class="linkname_icon_play"  id="0"></div>
                            <div id="prev" style="margin-top: 5px;" class="">
            <img  src="assets/images/prev.png" class="linkname_icon_prev"  ></div>
                
            </div>
        </div>
    </div>
</div>
</div>


<div class="footer-bg text-center">

    <h1></h1>
    <p>moqawama.org.lb</p>

</div>

<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script src="assets/bootstrap/js/bootstrap-slider.js"></script>
<script src="assets/js/wavesurferww.js"></script>
<script src="assets/js/jquery.cookie.js"></script>
            <script src="assets/plugin/bnews/js/breakingNews.js"></script>
                <script>
    $(window).load(function(e) {
        $("#bn1").breakingNews({
            effect		:"slide-v",
            autoplay	:true,
            timer		:3000,
            color		:"74b2b9"
        });
    });
</script>




<script type="text/javascript">
    var track_page = 1; //track user scroll as page number, right now page number is 1
    var loading  = false; //prevents multiple loads

    load_contents(track_page); //initial content load

    $(window).scroll(function() { //detect page scroll
        if($(window).scrollTop() + $(window).height() >= $(document).height()) { //if user scrolled to bottom of the page
            track_page++; //page number increment
            load_contents(track_page); //load content
        }
    });
    //Ajax load function
    function load_contents(track_page){
        if(loading == false){
            loading = true;  //set loading flag on
            $('.loading-info').show(); //show loading animation
            console.log(track_page);
            $.post( 'getTracks.php', {'page': track_page,'album':0,'q':'0'}, function(data){
                loading = false; //set loading flag off once the content is loaded
                if(data.trim().length == 0){
                    //notify user if nothing to load
                  $('.loading-info').html("<div class=\"loading-info-2\">عذراً, لا يوجد ملفات صوتية </div>");
                    return;

                }
                $('.loading-info').hide(); //hide loading animation once data is received
                //console.log(data);
                $("#results").append(data); //append data into #results element
                bindWaveSurfer();
                bindPlayButton();
                //rebindEvents();


            }).fail(function(xhr, ajaxOptions, thrownError) { //any errors?
                // alert(thrownError); //alert with HTTP error
            })
        }
    }
</script>


<script>

    function secondsTimeSpanToMS(s) {
        var m = Math.floor(s / 60); //Get remaining minutes
        s -= m * 60;
        s = Math.floor(s);
        return (m < 10 ? '0' + m : m) + ":" + (s < 10 ? '0' + s : s); //zero padding on minutes and seconds
    }

    var ctx = document.createElement('canvas').getContext('2d');
    var linGrad = ctx.createLinearGradient(0, 64, 0, 200);
    linGrad.addColorStop(0.5, 'rgba(39, 128, 277, 1.000)');
    linGrad.addColorStop(0.5, 'rgba(183, 183, 183, 1.000)');


    'use strict';
    var wavesurfer = [];
    var id = '';
    var oldids=[];
    var uniqueoldids=[];
    var myCounter;
    var playedTrack=[];
    var json_playedTrack;
    var current_time;
    var audio_duration;
    var width;
    var nextId;


    $(window).load(function() {
        bindWaveSurfer();
    });

    function bindWaveSurfer() {

        $(".play-button").each(function(index) {

            if (!$(this).hasClass('loaded')) {

                var id = $(this).attr('id').replace('play_track_', '');

                if (oldids.indexOf(id) > -1) {
                    //console.log("yes");
                } else {
                    oldids.push(id);
                    wavesurfer[id] = Object.create(WaveSurfer);
                    //console.log("no");


                    $.get('getLinkUrl.php?id=' + id, function (data) {

                        data = eval('(' + data + ')');
                        if (data['url'] != '') {
                            //alert(id);
                            wavesurfer[id].init({
                                backend: 'MediaElement',
                                container: '#wave_' + id,
                                waveColor: 'red',
                                progressColor: 'purple',
                                cursorColor: '#003273',
                                hideScrollbar: 'true',
                                normalize: true,
                                barWidth: 1,
                                height: 100

                            });

                            /*if (wavesurfer[id].backend.params.backend == 'AudioElement') {
                             $('#API_error').show();
                             }*/
                            var url = 'https://mediaspecial.org/sound/files/' + data['url'];
                            var json = 'https://mediaspecial.org/sound/files/' + data['json'];
                            //console.log(url);
                            wavesurfer[id].song=url;

                            var jdata = "";
                            var arr;

                            
                            $.get(json, function (data) {
                                
                                //console.log(JSON.parse(data).max)
                               // data = eval('(' + data + ')');
                                var jdata =JSON.parse(data).mid;
                                
                                if(jQuery.isEmptyObject(jdata) == true){
                                    
                                    var jdata =JSON.parse(data).left;

                                }

                                var arr = Object.keys(jdata).map(function (k) {
                                    return jdata[k]
                                });
                                arr = arr.filter(function (x) {
                                    return x > 0
                                });
                                //console.log(arr);
                                wavesurfer[id].backend.peaks =arr;
                                wavesurfer[id].drawBuffer();

                                //wavesurfer[id].load(url, arr);

                            }, 'html');
                            

                        } else {
                            //description.prepend('<div class="error" style="width:890px; float:left; text-align:center;">Track not found!</div>');
                            $(".play-button").addClass('notfound');
                        }
                    }, 'html');

                }

                //console.log(oldids);

            }
        });
    }

    function bindPlayButton() {

        $('div.play-button').unbind('click');
        $('div.play-button').click(function(e) {
            e.stopPropagation();
            var button = $(e.target);
            //console.log(button);
            id = button.attr('id').substr(11);



            $('div.play-button.playing').each(function(elem, index) {
                var id_holder = $(this).attr('id').substr(11);
                if (id_holder != id) {
                    $(this).removeClass('playing paused-button');
                    wavesurfer[id_holder].pause();
                }
            });


            if (button.hasClass('notfound')) {
                return;
            }
            if (button.hasClass('unplayed')) {

                button.addClass('loaded playing paused-button');
                wavesurfer[id].load(wavesurfer[id].song, wavesurfer[id].backend.peaks);
                wavesurfer[id].play();
                



  

                wavesurfer[id].on('loading', function () {

                });


                $('.link_play').attr("data-url",wavesurfer[id].song);
                $('.playlist').css({ 'display': "block" });

                $.get('linkinprogress.php?id=' + id, function (data) {

                    data = eval('(' + data + ')');
                    $('.linkname_h3_play ').text(data['linkname']);
                    $('.linkimage_play').attr("src",data['image']);
                    $('.linkname_icon_play').attr("onclick","wavesurfer["+id+"].playPause()");
                    $('.linkname_icon_play').attr("src","assets/images/pause.png");
                    $('.linkname_icon_play').attr("id",id);
                }, 'html');

                // Request the mycounterpage, data being the HTML given.
                myCounter = $('#my_counter_'+id);
                $.get('updateCounter.php?id='+id, function(data) {
                    // Set the output HTML to the counter element.
                    myCounter.html('<i class="fa fa-soundcloud"></i> إستمع له '+data+' مرة</a>');           
                    });

                wavesurfer[id].on('finish', function() {
                    $('#play_track_' + id).removeClass('paused-button');
                    $('#play_track_' + id).addClass('finished');
                });
                button.removeClass('unplayed');


                var json_str = $.cookie('myids');
                if(json_str){
                    playedTrack = JSON.parse(json_str);
                }
                if (playedTrack.indexOf(id) > -1) {
                } else {
                    playedTrack.push(id);
                    json_playedTrack = JSON.stringify(playedTrack);
                    $.cookie('myids', json_playedTrack, { expires: 7 });
                }

            } else {
                if (button.hasClass('finished')) {
                    wavesurfer[id].seekTo(0);
                    button.addClass('playing paused-button');
                    button.removeClass('finished');
                    wavesurfer[id].play();
                    $('.linkname_icon_play').attr("onclick","wavesurfer["+id+"].playPause()");
                    $('.linkname_icon_play').attr("src","assets/images/pause.png");


                } else if (button.hasClass('playing')) {
                    button.removeClass('playing paused-button');
                    wavesurfer[id].pause();
                    $('.linkname_icon_play').attr("onclick","wavesurfer["+id+"].playPause()");
                    $('.linkname_icon_play').attr("src","assets/images/play.png");

                } else {
                    button.addClass('playing paused-button');
                    wavesurfer[id].play();
                    $('.linkname_icon_play').attr("onclick","wavesurfer["+id+"].playPause()");
                    $('.linkname_icon_play').attr("src","assets/images/pause.png");

                }
            }


            wavesurfer[id].on('audioprocess', function() {
                current_time = wavesurfer[id].getCurrentTime();
                $('.wavesurfer-time').html(secondsTimeSpanToMS(current_time));
                width=wavesurfer[id].backend.getPlayedPercents() * 100;
                $('.progress_bar').css('width',width+'%')
            });

            wavesurfer[id].on('ready', function() {
                audio_duration = wavesurfer[id].getDuration();
                $('.wavesurfer-duration').html(secondsTimeSpanToMS(audio_duration));
                
            wavesurfer[id].setVolume(0.5);
           document.querySelector('#volume').value = wavesurfer[id].backend.getVolume();
           
               var volumeInput = document.querySelector('#volume');
                var onChangeVolume = function (e) {
                    wavesurfer[id].setVolume(e.target.value);
                    console.log(e.target.value);
                        };
                volumeInput.addEventListener('input', onChangeVolume);
                volumeInput.addEventListener('change', onChangeVolume);
  
           

            });

            wavesurfer[id].on('seek', function() {
                current_time = wavesurfer[id].getCurrentTime();
            });

            wavesurfer[id].on('pause', function() {
                current_time = wavesurfer[id].getCurrentTime();
            });
            
            
              $.get('linkinprogress.php?id=' + id, function (data) {

                    data = eval('(' + data + ')');
                    $('.linkname_h3_play ').text(data['linkname']);
                    $('.linkimage_play').attr("src",data['image']);
                    $('.linkname_icon_play').attr("onclick","wavesurfer["+id+"].playPause()");
                    $('.linkname_icon_play').attr("src","assets/images/pause.png");
                    $('.linkname_icon_play').attr("id",id);
                }, 'html');
                
                
            
            

        });


        $('.linkname_icon_play').click(function(e) {
            e.stopPropagation();
            var button2 = $(e.target);
            var id2 = button2.attr('id');
            wavesurfer[id2].on('pause', function () {
                $('.linkname_icon_play').attr("src","assets/images/play.png");
                $('#play_track_' + id2).removeClass('playing paused-button');
            });


            wavesurfer[id2].on('play', function () {
                $('.linkname_icon_play').attr("src","assets/images/pause.png");
                $('#play_track_' + id2).addClass('playing paused-button');
            });

        });

        $('#skip').click(function(e) {
            console.log("skip button is clicked");
            e.stopPropagation();
            var myid = $('.playing').data('id');
            var next = $(".playing").data('nextid');
            console.log(myid);
            wavesurfer[myid].pause();
            $('#play_track_' + myid).removeClass().addClass('play-button unplayed');
            $('#play_track_' + next).addClass('loaded playing paused-button');
            wavesurfer[next].load(wavesurfer[next].song, wavesurfer[next].backend.peaks);
            wavesurfer[next].play();

        });

        $('#prev').click(function(e) {
            console.log("prev button is clicked");
            e.stopPropagation();
            var myid = $('.playing').data('id');
            var prev = $(".playing").data('previousid');
            console.log(myid);
            wavesurfer[myid].pause();
            $('#play_track_' + myid).removeClass().addClass('play-button unplayed');
            $('#play_track_' + prev).addClass('loaded playing paused-button');
            wavesurfer[prev].load(wavesurfer[prev].song, wavesurfer[prev].backend.peaks);
            wavesurfer[prev].play();

        });


    }

</script>

<script>
    $(document).ready(function() {
        if($('#playlisttracks').length >0 ){
            var json_str = $.cookie('myids');

            $.post( 'getTracksfromcookie.php', {'array': json_str}, function(data){
                $("#playlisttracks").append(data); //append data into #results element
                bindWaveSurfer();
                bindPlayButton();

            }).fail(function(xhr, ajaxOptions, thrownError) { //any errors?
                alert(thrownError); //alert with HTTP error
            })
        }
    });
</script>

</body>
</html>